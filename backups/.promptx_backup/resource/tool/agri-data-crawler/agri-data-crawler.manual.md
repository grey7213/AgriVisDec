<manual>
<identity>
## 工具名称
@tool://agri-data-crawler

## 简介
专业的农业数据爬虫工具，支持从种子交易网、天气网、农机网等多个农业数据源自动采集结构化数据
</identity>

<purpose>
⚠️ **AI重要提醒**: 调用此工具前必须完整阅读本说明书，理解工具功能边界、参数要求和使用限制。禁止在不了解工具功能的情况下盲目调用。

## 核心问题定义
解决农业信息分散、数据获取困难的问题，为农户提供统一的农业数据采集入口，支持种子价格、天气信息、农机设备等多维度数据的自动化获取。

## 价值主张
- 🎯 **解决什么痛点**：手动收集农业数据耗时费力，数据源分散，格式不统一
- 🚀 **带来什么价值**：自动化数据采集，节省90%的数据收集时间，提供标准化数据格式
- 🌟 **独特优势**：专门针对农业领域优化，支持多个主流农业网站，内置数据清洗和验证

## 应用边界
- ✅ **适用场景**：
  - 种子价格信息采集（中国种子交易网）
  - 天气数据获取（中国天气网）
  - 农机设备信息抓取（农机360网）
  - 农产品价格监控
  - 农业政策信息收集
- ❌ **不适用场景**：
  - 需要登录认证的私有数据
  - 实时性要求极高的数据（<1分钟）
  - 大规模并发爬取（>100并发）
  - 违反网站robots.txt的数据
</purpose>

<usage>
## 使用时机
- 需要定期更新农业基础数据时
- 建立农业数据看板前的数据准备
- 进行农业市场分析需要数据支撑时
- 为农户提供决策支持需要最新数据时

## 操作步骤
1. **准备阶段**：
   - 确定需要采集的数据类型和网站
   - 检查目标网站的robots.txt文件
   - 准备数据存储的数据库连接信息

2. **执行阶段**：
   - 配置爬虫参数（网站类型、数据字段、采集频率）
   - 启动数据采集任务
   - 监控采集进度和数据质量

3. **验证阶段**：
   - 检查采集数据的完整性和准确性
   - 验证数据格式是否符合预期
   - 确认数据已正确存储到目标位置

## 最佳实践
- 🎯 **效率提升技巧**：
  - 使用合理的请求间隔（建议1-3秒）
  - 批量处理数据，减少数据库写入次数
  - 设置User-Agent和请求头，模拟正常浏览器访问
  - 使用缓存机制，避免重复采集相同数据

- ⚠️ **常见陷阱避免**：
  - 不要设置过高的并发数，避免被网站封禁
  - 注意处理网站的反爬虫机制（验证码、IP限制等）
  - 定期检查网站结构变化，及时更新选择器
  - 遵守网站的使用条款和robots.txt规定

- 🔧 **故障排除指南**：
  - 采集失败：检查网络连接和目标网站状态
  - 数据格式错误：验证CSS选择器和数据解析逻辑
  - 被网站封禁：降低请求频率，更换User-Agent
  - 数据不完整：检查页面加载时间和动态内容处理

## 注意事项
- **合规性要求**：严格遵守目标网站的robots.txt和使用条款
- **频率控制**：建议请求间隔不少于1秒，避免对目标网站造成压力
- **数据质量**：采集后需要进行数据清洗和验证
- **异常处理**：网络异常或网站结构变化时要有降级方案
- **存储安全**：敏感数据要加密存储，遵循数据保护法规
</usage>

<parameter>
## 必需参数
| 参数名 | 类型 | 描述 | 示例 |
|--------|------|------|------|
| website | string | 目标网站类型 | "seed_trade", "weather", "farm_machine" |
| data_type | string | 需要采集的数据类型 | "price", "weather_forecast", "product_info" |

## 可选参数
| 参数名 | 类型 | 默认值 | 描述 |
|--------|------|--------|------|
| region | string | "全国" | 数据采集的地区范围 |
| date_range | object | 当天 | 采集数据的时间范围 |
| max_pages | number | 10 | 最大采集页数 |
| delay | number | 2000 | 请求间隔时间（毫秒） |
| output_format | string | "json" | 输出数据格式 |
| save_to_db | boolean | false | 是否直接保存到数据库 |
| db_config | object | null | 数据库连接配置 |

## 参数约束
- **website**: 必须是支持的网站类型之一
- **data_type**: 必须与选择的网站类型匹配
- **max_pages**: 范围1-100，避免过度采集
- **delay**: 最小值1000毫秒，保护目标网站
- **region**: 支持省市名称或"全国"

## 参数示例
```json
{
  "website": "seed_trade",
  "data_type": "price",
  "region": "山东省",
  "date_range": {
    "start": "2024-01-01",
    "end": "2024-01-31"
  },
  "max_pages": 5,
  "delay": 2000,
  "output_format": "json",
  "save_to_db": true,
  "db_config": {
    "host": "localhost",
    "database": "agri_data",
    "table": "seed_prices"
  }
}
```
</parameter>

<outcome>
## 成功返回格式
```json
{
  "success": true,
  "data": {
    "total_records": 156,
    "crawled_pages": 5,
    "data_records": [
      {
        "product_name": "玉米种子",
        "variety": "先玉335",
        "price": 45.8,
        "unit": "元/斤",
        "region": "山东济南",
        "date": "2024-01-15",
        "source_url": "https://example.com/seed/123"
      }
    ],
    "metadata": {
      "crawl_time": "2024-01-15T10:30:00Z",
      "website": "seed_trade",
      "data_quality_score": 0.95,
      "processing_time": 45000
    }
  }
}
```

## 错误处理格式
```json
{
  "success": false,
  "error": {
    "code": "NETWORK_ERROR",
    "message": "目标网站连接失败",
    "details": {
      "website": "seed_trade",
      "attempted_urls": ["https://example.com/page1"],
      "retry_count": 3,
      "last_error": "ECONNREFUSED"
    },
    "suggestions": [
      "检查网络连接",
      "确认目标网站是否正常运行",
      "稍后重试或联系网站管理员"
    ]
  }
}
```

## 结果解读指南
- **数据质量评估**：metadata.data_quality_score > 0.8 表示数据质量良好
- **采集效率判断**：processing_time / total_records 可评估采集效率
- **数据完整性检查**：对比 total_records 和实际返回的 data_records 数量
- **异常数据识别**：检查价格、日期等字段是否在合理范围内

## 后续动作建议
- **成功采集后**：
  - 进行数据清洗和去重处理
  - 将数据导入到农业数据看板系统
  - 设置定时任务进行定期更新
  - 建立数据质量监控机制

- **采集失败时**：
  - 根据错误代码调整参数重试
  - 检查目标网站是否有结构变化
  - 考虑使用备用数据源
  - 记录失败原因用于后续优化

- **数据应用建议**：
  - 结合历史数据进行趋势分析
  - 为农户提供价格预警服务
  - 生成农业市场分析报告
  - 支持农业决策支持系统
</outcome>
</manual>
